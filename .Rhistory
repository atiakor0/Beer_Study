setwd("E:/University/Doing Data Science/Unit 7/Beer_Study")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
setwd("E:/University/Doing Data Science/Unit 7/Beer_Study")
library(ggplot2) # Data visualization
library(readr) # CSV file I/O, e.g. the read_csv function
library(dplyr) # Heavy use of this library
library(tidyr)
library(plyr)
library(ggthemes) # for themes in ggplot
library(knitr)
library(kableExtra) # library to make the document more presentable
library(Amelia) # for missing map
library(datasets) # to make region col
library(zoo)
Beers <- read_csv('Beers.csv', col_types = cols())
Breweries <- read_csv('Breweries.csv', col_types = cols())
BrewPerState <- table(Breweries$State)
BrewPerState
kable(BrewPerState)
BrewPub <- merge(Beers, Breweries, by.x = "Brewery_id", by.y = "Brew_ID", all = TRUE)
# Change variable names to more meaningful title
BrewPub <- rename(BrewPub, c("Name.x"="Beer","Name.y"="Brewery",
"Ounces"="OZ"))
# Used kable library to make document more presentable
kable(BrewPub %>%
head()) %>%
kable_styling("striped", full_width = F)
kable(BrewPub %>%
tail()) %>%
kable_styling("striped", full_width = F)
MissingValues <- sapply(BrewPub,function(MissingValue)sum(is.na(MissingValue)))
# Used kable library to make document more presentable
as.data.frame(MissingValues) %>%
kable("html") %>%
kable_styling("striped", full_width = F)
missmap(BrewPub,y.at=c(1),y.labels = c(''),col=c('yellow','black'))
Alc <- BrewPub %>%
na.omit()  %>%
group_by(State) %>%
summarise_each(funs(median), Median_ABV = ABV) %>%
arrange(Median_ABV)
Alc
Bitter <- BrewPub %>%
na.omit() %>%
group_by(State) %>%
summarise_each(funs(median), Median_IBU = IBU) %>%
arrange(Median_IBU)
Bitter
ggplot(data=Alc, aes(x=State, y=Median_ABV)) +
geom_bar(stat="identity", fill="red")+
theme_bw() +
scale_color_economist()+
theme(axis.text.x=element_text(size=rel(0.8), angle=90),plot.title = element_text(size=14,hjust = 0.5, face="bold.italic")) +
ggtitle("Median ABV by State") +
labs(x="State",y="ABV")
ggplot(data=Bitter, aes(x=State, y=Median_IBU)) +
geom_bar(stat="identity", fill="steelblue")+
theme_bw() +
scale_color_economist()+
theme(axis.text.x=element_text(size=7, angle=90),plot.title = element_text(size=14,hjust = 0.5, face="bold.italic"))+ ggtitle("Median IBU by State") + labs(x="State",y="IBU")
# finding state which has has the maximum alcoholic (ABV) beer
Max_ABV <- BrewPub[which.max(BrewPub$ABV),]
Max_ABV
# finding state which has has the maximum alcoholic (IBU) beer
Max_IBU <- BrewPub[which.max(BrewPub$IBU),]
Max_IBU
summary(BrewPub$ABV)
ggplot(BrewPub, aes(x=BrewPub$IBU, y=BrewPub$ABV)) + geom_point() + geom_smooth(method=lm, se=FALSE) + theme(plot.title = element_text(size=14,hjust= 0.5, face="bold.italic")) + ggtitle("Relationship Between Bitterness of Beer and Its Alcoholic Content") +
labs(x="Bitterness",y="Alcoholic Content")
reg1 <- lm(ABV ~ IBU, data = BrewPub)
# Summary of reg 1
summary(reg1)
Regressionplot <- function (reg) {
require(ggplot2)
ggplot(reg$model, aes_string(x = names(reg$model)[2], y = names(reg$model)[1])) + geom_point() + stat_smooth(method = "lm", col = "red") + labs(title = paste("Adj R2 = ",signif(summary(reg)$adj.r.squared, 5), "Intercept =",signif(reg$coef[[1]],5 ), " Slope =",signif(reg$coef[[2]], 5), " P =",signif(summary(reg)$coef[2,4], 5)))
}
Regressionplot(reg1)
StateAbb <- as.data.frame(state.abb) # usnig stat.abb dataset
StateRegion <- as.data.frame(state.region) # using state.region dataset
# Combine 2 datasets
State <- cbind(StateAbb,StateRegion)
names(State) <- c("State" , "Region")
# Merge State by BrewPub
BrewRegion <- merge(BrewPub,State, by="State")
# Replacing IBU Missing Value by Region mean
BrewRegion[is.na(BrewRegion$IBU), "IBU"] <- tapply(BrewRegion$IBU, BrewRegion$Region, mean,na.rm=TRUE)[ BrewRegion[is.na(BrewRegion$IBU),"Region"]]
# Replacing ABV Missing Value by Region mean
BrewRegion[is.na(BrewRegion$ABV), "ABV"] <- tapply(BrewRegion$ABV, BrewRegion$Region, mean,na.rm=TRUE)[ BrewRegion[is.na(BrewRegion$ABV),"Region"]]
# Missing Map after replacing NAs by mean
missmap(BrewRegion,y.at=c(1),y.labels = c(''),col=c('yellow','black'))
ABV_Hist <- ggplot(BrewRegion,aes(x=ABV)) + geom_histogram(aes(fill=Region)) +theme(axis.text.x=element_text(size=7), plot.title = element_text(size=14,hjust = 0.5, face="bold.italic"))+ ggtitle("Histogram of Alcohol Content By Region") + labs(x="ABV",y="Count")
ABV_Hist
# Histogram of IBU
IBU_Hist <- ggplot(BrewRegion,aes(x=IBU)) + geom_histogram(aes(fill=Region)) +theme(axis.text.x=element_text(size=7), plot.title = element_text(size=14,hjust = 0.5, face="bold.italic")) + ggtitle("Histogram of Beer Bitterness By Region") + labs(x="IBU",y="Count")
IBU_Hist
ABV_Box<-ggplot((BrewRegion), aes(x = Region, y = ABV)) + geom_boxplot() + theme(axis.text.x=element_text(size=7, angle=90), plot.title = element_text(size=14,hjust = 0.5, face="bold.italic"))+ ggtitle("Boxplot of Alcohol Content By Region") + labs(x="Region",y="ABV")
ABV_Box
ABV_Hist <- ggplot(BrewRegion,aes(x=ABV)) + geom_histogram(aes(fill=Region)) +theme(axis.text.x=element_text(size=7), plot.title = element_text(size=14,hjust = 0.5, face="bold.italic"))+ ggtitle("Histogram of Alcohol Content By Region") + labs(x="ABV",y="Count")
ABV_Hist
# Histogram of ABV
ABV_Hist <- ggplot(BrewRegion,aes(x=ABV)) + geom_histogram(colour="black", fill="white") +theme(axis.text.x=element_text(size=7), plot.title = element_text(size=14,hjust = 0.5, face="bold.italic")) + theme_bw() + ggtitle("Histogram of Alcohol Content By Region") + labs(x="ABV",y="Count") +  facet_grid(Region ~ .)
ABV_Hist
# Histogram of ABV
ABV_Hist <- ggplot(BrewRegion,aes(x=ABV)) + geom_histogram(colour="black", fill="white") +theme(axis.text.x=element_text(size=7), plot.title = element_text(size=14,hjust = 0.5, face="bold.italic")) + theme_bw() + ggtitle("Histogram of Alcohol Content By Region") + labs(x="ABV",y="Count") +  facet_grid(Region ~ .)
ABV_Hist
Histogram of IBU
# Histogram of IBU
IBU_Hist <- ggplot(BrewRegion,aes(x=IBU)) + geom_histogram(colour="black", fill="white") +theme(axis.text.x=element_text(size=7), plot.title = element_text(size=14,hjust = 0.5, face="bold.italic")) + theme_bw() + ggtitle("Histogram of Beer Bitterness By Region") + labs(x="IBU",y="Count") + facet_grid(Region ~ .)
IBU_Hist
# Boxplot of Alcohol Content By Region
Alch<-ggplot((BrewRegion), aes(x = Region, y = ABV)) + geom_boxplot() + theme(axis.text.x=element_text(size=7, angle=90), plot.title = element_text(size=14,hjust = 0.5, face="bold.italic"))+ ggtitle("Boxplot of Alcohol Content By Region") + labs(x="Region",y="ABV")
Alch
Alch<-ggplot((BrewRegion), aes(x = Region, y = ABV)) + geom_boxplot() + theme(axis.text.x=element_text(size=7, angle=90), plot.title = element_text(size=14,hjust = 0.5, face="bold.italic"))+ ggtitle("Boxplot of Alcohol Content By Region") + labs(x="Region",y="ABV")
Alch
